(this["webpackJsonpgitlab-status"]=this["webpackJsonpgitlab-status"]||[]).push([[0],{22:function(e,t,n){e.exports=n.p+"static/media/successIcon.eecad4ab.svg"},23:function(e,t,n){e.exports=n.p+"static/media/failedIcon.fb36fc3e.svg"},24:function(e,t,n){e.exports=n.p+"static/media/inProgressIcon.eeff3d0f.svg"},30:function(e,t,n){e.exports=n(41)},35:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),o=n(19),i=n.n(o),c=(n(35),n(36),n(10)),l=n(7),s=n(14),u=n(20),d=n(15),g=n(29),m=n(21),f=n.n(m),p=n(22),b=n.n(p),h=n(23),v=n.n(h),E=n(24),y=n.n(E),w=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some((function(e){return"FAILED"===e}))?v.a:t.some((function(e){return"CREATED"===e||"WAITING_FOR_RESOURCE"===e||"PREPARING"===e||"RUNNING"===e}))?y.a:b.a},S=Object(a.createContext)(void 0),j=function(e){var t=e.children,n=Object(a.useState)(new Map),o=Object(c.a)(n,2),i=o[0],l=o[1],s=Object(a.useMemo)((function(){return function(e,t){l((function(n){return n.get(e)===t?n:((n=new Map(n)).set(e,t),n)}))}}),[]);return r.a.createElement(S.Provider,{value:s},r.a.createElement(f.a,{url:w.apply(void 0,Object(g.a)(Array.from(i.values())))}),t)};function k(){var e=Object(u.a)(["\n  query projectStatus($fullPath: ID!) {\n    project(fullPath: $fullPath) {\n      name\n      webUrl\n      environments {\n        nodes {\n          name\n        }\n      }\n      repository {\n        tree {\n          lastCommit {\n            title\n            webUrl\n            author {\n              avatarUrl\n              name\n            }\n          }\n        }\n      }\n      pipelines(first: 1) {\n        nodes {\n          status\n          detailedStatus {\n            label\n            detailsPath\n          }\n          finishedAt\n        }\n      }\n    }\n  }\n"]);return k=function(){return e},e}var x,O=function(e){var t,n,a=e.children,o=e.columns,i=void 0===o?{}:o;return r.a.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(".concat(null!==(t=i.count)&&void 0!==t?t:"auto-fit",", ").concat(null!==(n=i.width)&&void 0!==n?n:230,"px)"),gridGap:40,padding:40,justifyContent:"center"}},a)},T=Object(s.b)(k()),I=function(e){var t=e.projectPath,n=Object(a.useContext)(S),o=Object(d.a)(T,{variables:{fullPath:t},pollInterval:1e4});if(o.error)return r.a.createElement("p",null,"Error fetching project status:",r.a.createElement("pre",null,r.a.createElement("code",null,"".concat(o.error))));if(o.loading)return r.a.createElement("p",null,"Loading...");var i=o.data.project;if(!i)return r.a.createElement("p",null,"Missing project ",t);n(t,i.pipelines.nodes[0].status);var c=new URL(i.webUrl);return r.a.createElement("div",{style:{display:"grid",alignContent:"start",gridGap:8,gridTemplateRows:"min-content 1fr min-content"}},r.a.createElement("a",{href:i.webUrl,target:"gitlab",style:{display:"flex",alignItems:"center"}},r.a.createElement("h3",{style:{margin:0,flex:1}},i.name),r.a.createElement("a",{href:"".concat(c.protocol,"//").concat(c.host).concat(i.pipelines.nodes[0].detailedStatus.detailsPath),target:"gitlab",style:{marginLeft:8,width:20,height:20,backgroundImage:"url(".concat(w(i.pipelines.nodes[0].status),")"),backgroundSize:"contain"}},r.a.createElement("span",{style:{visibility:"hidden"}},i.pipelines.nodes[0].detailedStatus.label))),r.a.createElement("a",{href:"".concat(i.repository.tree.lastCommit.webUrl),target:"gitlab",style:{opacity:.9}},i.repository.tree.lastCommit.title),r.a.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:8}},r.a.createElement("img",{src:"".concat(c.protocol,"//").concat(c.host).concat(i.repository.tree.lastCommit.author.avatarUrl),alt:"",style:{marginRight:8,width:32,height:32,borderRadius:"50%"}}),i.repository.tree.lastCommit.author.name))};try{var C=localStorage.getItem("accessToken"),R=localStorage.getItem("config");C&&R&&(x={accessToken:C,config:JSON.parse(R)})}catch(A){console.error("Error reading config",A)}var P=function(e){var t,n=Object(a.useState)(null!==(t=e.settings.accessToken)&&void 0!==t?t:""),o=Object(c.a)(n,2),i=o[0],l=o[1],s=Object(a.useState)((function(){return e.settings.config?JSON.stringify(e.settings.config,void 0,2):""})),u=Object(c.a)(s,2),d=u[0],g=u[1];return r.a.createElement("form",{style:{display:"flex",flexDirection:"column",boxSizing:"border-box",paddingBottom:54,margin:"auto",height:"100vh",maxWidth:600},onSubmit:function(e){e.preventDefault(),function(e){localStorage.setItem("accessToken",e.accessToken),localStorage.setItem("config",JSON.stringify(e.config)),window.location.reload()}({accessToken:i,config:JSON.parse(d)})}},r.a.createElement("label",{htmlFor:"accessToken"},"Gitlab Access Token"),r.a.createElement("input",{id:"accessToken",name:"accessToken",value:i,onChange:function(e){return l(e.target.value)},style:{padding:"4px 8px",border:"none",borderRadius:5,background:"rgba(255, 255, 255, 0.9)"}}),r.a.createElement("label",{htmlFor:"accessToken"},"Dashboard Config"),r.a.createElement("textarea",{id:"config",name:"config",value:d,onChange:function(e){return g(e.target.value)},style:{flex:1,padding:8,border:"none",borderRadius:5,background:"rgba(255, 255, 255, 0.9)"}}),r.a.createElement("button",{style:{alignSelf:"flex-end",marginTop:32,padding:"8px 24px",fontSize:18,border:"none",borderRadius:5,color:"white",background:"rgba(255, 255, 255, 0.3)"}},"Save"))},U=function(e){var t=Object(a.useState)((function(){return new s.a({uri:"".concat(e.settings.config.gitlabUrl,"/api/graphql"),headers:e.settings.accessToken?{Authorization:"Bearer ".concat(e.settings.accessToken)}:void 0})})),n=Object(c.a)(t,1)[0];return r.a.createElement(l.a,{client:n},r.a.createElement(j,null,e.settings.config.dashboards.map((function(t){return r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:e.showSettings,style:{position:"fixed",top:42,right:42,padding:0,border:"none",color:"white",background:"none"}},"Settings"),r.a.createElement("h1",{style:{paddingTop:20,textAlign:"center"}},t.name),r.a.createElement(O,{columns:t.columns},t.widgets.map((function(e){return r.a.createElement(I,{projectPath:e.projectPath})}))))}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement((function(){var e=Object(a.useState)(void 0===x),t=Object(c.a)(e,2),n=t[0],o=t[1];return n||!x?r.a.createElement(P,{settings:null!==x&&void 0!==x?x:{accessToken:""}}):r.a.createElement(U,{settings:x,showSettings:function(){return o(!0)}})}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.60556055.chunk.js.map